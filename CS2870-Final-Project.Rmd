---
title: "CS2870-Final-Project"
output: pdf_document
date: "2023-11-14"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse, dplyr, usmap, maps, ggthemes, sf)
crime_data <- read.csv("crime_data.csv")

us_states <- map_data(map = "state")

theme_set(theme_map())
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r victim_sex/crime analysis}

ggplot(
  data = crime_data,
  mapping = aes(
    x = victim_age
  ),
) +
  
  geom_density(
    color = "black",
    fill = "firebrick"
  ) +
  
  labs(
    x = "Age of Victim",
    y = "Number of Crimes",
    title = "Number of Crimes Committed on People of Age X"
  ) +
  
  theme(
    plot.background = element_rect(fill = "gray17"),
    panel.background = element_rect(fill = "gray17"),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    axis.text = element_text(color = "gray"),
    axis.line.x = element_line(color = "gray"),
    axis.line.y = element_line(color = "gray"),
    axis.title.x = element_text(color = "gray"),
    axis.title.y = element_text(color = "gray"),
    plot.title = element_text(color = "gray", hjust = .5)
  ) +
  
  scale_y_continuous(
    expand = c(0,0,0.25,0),
    breaks = c(0,5000,10000,15000,20000,25000,30000)
  ) +
  
  scale_x_continuous(
    expand = c(0.025,0.05,0.05,0),
    breaks = c(0,10,20,30,40,50,60,70,80,90)
  )

```

```{r density usa map crimes}

ggplot(
  data = us_states,
  mapping = aes(
    x = long,
    y = lat,
    group = group
  )
) +

  # Use geom_polygon to draw the lines for each state
  geom_polygon(
    color = "black",
    fill = "white"
  ) + 
  
  # Add the correct theme below
  theme_map() +
   
  # Add this function to make the map look more like what it would be on a globe
  coord_map(projection = "albers", 
            lat0 = 39, lat1 = 45) +
  
  geom_point(
    data = crime_data,
    mapping = aes(
      x = long,
      y = lat,
      group = area_name
    )
  ) +
  
  scale_x_continuous(
    expand = c(0,0)
  ) +
  
  scale_y_continuous(
    expand = c(0,0)
  ) 

```


## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

